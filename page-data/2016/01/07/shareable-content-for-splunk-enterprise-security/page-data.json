{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/2016/01/07/shareable-content-for-splunk-enterprise-security/",
    "result": {"data":{"site":{"siteMetadata":{"title":"RFaircloth Data Nerd"}},"markdownRemark":{"id":"a41d5408-3db3-59af-8808-8ba93af76419","excerpt":"Splunk has initial support for export of “content” which can be dashboards and correlation searches created by the user to share with another team. What if you…","html":"<p>Splunk has initial support for export of “content” which can be dashboards and correlation searches created by the user to share with another team. What if you need to be a little more complex for example including a lookup generating search? This will get a little more complicated but very doable by the average admin. Our mission here is to implement UC0029. What is UC0029 glad you ask Each new malware signature detected should be reviewed by a security analyst to determine if proactive steps can be taken to prevent infection. We will create this as a notable event so that we can provide evidence to audit that the process exists and was followed.</p>\n<p>Source code will be provided so I will not detail step by step how objects will be created and defined for this post</p>\n<h1>UC0029 Endpoint new malware detected by signature</h1>\n<p>My “brand” is SecKit so you will see this identifier in content I have created alone or with my team here at Splunk. As per our best practice adopt your own brands and use appropriately for your content. There is no technical reason to replace the “brand” on third party content you elect to utilize.</p>\n<p>Note ensure all knowledge objects are exported as all app’s owned by admin as you go</p>\n<ul>\n<li>Create a DA-ESS-SecKit-EndpointProtection\n<ul>\n<li>This will contain ES specific content such as menus dashboards, and correlation searches</li>\n</ul>\n</li>\n<li>Create the working app SA-SecKit-EndpointProtection\n<ul>\n<li>This will contain props transforms lookups and scheduled searches created outside of ES</li>\n</ul>\n</li>\n<li>Create the lookup seckit_endpoint_malware_tracker this lookup will contain each signature as it is detected in the environment and some handy information such as the endpoint first detected, user involved and the most recent detection.</li>\n<li>Create empty lookup CSV files\n<ul>\n<li>seckit_endpoint_malware_tracker.csv (note you will not ship this file in your content pack)</li>\n<li>seckit_endpoint_malware_tracker.csv.default</li>\n</ul>\n</li>\n</ul>\n<p>Build and test the saved search SecKit Malware Tracker – Lookup Gen. This search will use tstats to find the first and last instance of all signatures in a time window and update the lookup if an earlier or later instance is found</p>\n<p>Build and test the correlation search UC0029-S01-V001 New malware signature detected. This search will find “new” signatures from the lookup we have created and create a notable event”Make it default” In both apps move content from local/ to default/ this will allow your users to customize the content without replacing the existing searches”Turn if off by default” It is best practice to ensure any load generating searches are disabled by default add disabled=1 to each savedsearches.conf stanza that does not end in”- Rule”add disabled=1 to each correleationsearches.conf</p>\n<p>Create a spl (tar.gz) containing both apps createdWrite a blog post explaining what you did, how the searches work and share the code!Gain fame and respect maybe a fez or a cape</p>\n<p>The source code</p>\n<p><a href=\"https://bitbucket.org/rfaircloth-splunk/securitykit/src/1ea60c46b685622116e28e8f1660a6c63e7d9e96/base/ess/?at=master\">https://bitbucket.org/rfaircloth-splunk/securitykit/src/1ea60c46b685622116e28e8f1660a6c63e7d9e96/base/ess/?at=master</a></p>\n<p>Bonus: Delegate administration of content app</p>\n<ol>\n<li>Using your favorite editor edit app/metadata/local.meta</li>\n<li>Update the following permisions adding “ess_admin” role</li>\n</ol>\n<blockquote>\n<p>## access = read : [ * ], write : [ admin,role2,role3 ]<br>\n[savedsearches]<br>\naccess = read : [ * ], write : [ admin,<span style=\"color: #ff00ff;\">ess_admin </span>]</p>\n<p>[correlationsearches]<br>\naccess = read : [ * ], write : [ admin,<span style=\"color: #ff00ff;\">ess_admin</span> ]</p>\n</blockquote>","frontmatter":{"title":"Share that search! Building a content pack for Splunk Enterprise Security 4.0+","date":"January 07, 2016","description":null}},"previous":{"fields":{"slug":"/2015/12/23/advancing-security-through-the-use-of-security-assessments/"},"frontmatter":{"title":"Advancing security through the use of security assessments"}},"next":{"fields":{"slug":"/2016/01/07/making-asset-data-useful-with-splunk-enterprise-security/"},"frontmatter":{"title":"Making Asset data useful with Splunk Enterprise Security CSC 1 Part 1"}}},"pageContext":{"id":"a41d5408-3db3-59af-8808-8ba93af76419","previousPostId":"041f7c5e-48c8-5320-ae4d-8d42f63523d0","nextPostId":"558f8730-f0a8-5ebd-94a4-a2f4c8264311"}},
    "staticQueryHashes": ["2841359383","3257411868"]}