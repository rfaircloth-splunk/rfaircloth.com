{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/2015/11/05/getting-all-the-logs-avoiding-the-wec/",
    "result": {"data":{"site":{"siteMetadata":{"title":"RFaircloth Data Nerd"}},"markdownRemark":{"id":"e69d9166-3334-5378-8536-f1dc83e9c647","excerpt":"I get asked about this one often, I happen to have a bit of experience with this which is very rare. There is scant documentation on the technology from…","html":"<p>I get asked about this one often, I happen to have a bit of experience with this which is very rare. There is scant documentation on the technology from Microsoft or anyone else. I do know of some success being had with very specific low volume use cases but that’s not what I do. I’m a specialist of sorts I walk of a Delta plane, drop my bag at a Marriott then walk into change someones world with data. Actual facts about their environment from their environment and I need and use data my customers don’t know they had. Which brings me to Windows Event Collection (WEC).</p>\n<p>Customer ask me about it its seems so easy lets talk about the parts</p>\n<ul>\n<li>Group policy use to make changes to all systems in an environment.</li>\n<li>Remote Power Shell</li>\n<li>COM/DCOM/Com+ and all of the RPC that goes with it</li>\n<li>Kerberos authentication</li>\n</ul>\n<p>How does it work?</p>\n<ol>\n<li>Group policy instructs the computer to connect to a collector and gather a policy</li>\n<li>Policy read causes a Com+ server to read the event log (yes this is code you have not been running it can and will impact your endpoints)</li>\n<li>Local filter determines what do do with this event (xml parsing with XPATH and XSLT)</li>\n<li>RPC call using computer account to Collector</li>\n<li>Denial (Auth required)</li>\n<li>Authentication (event log write on DC and on Collector)</li>\n<li>Serial write with sync and block to round robin data base on the server. So if 300 events come in these have to get in queue to go to disk.</li>\n<li>Close connection</li>\n<li>Poll period go back to 3</li>\n</ol>\n<p>Lots of steps? Lets ask about failure modes</p>\n<ul>\n<li>What happens if my collector is down\n<ul>\n<li>Answer client goes to sleep and retries hope your logs don’t wrap</li>\n</ul>\n</li>\n<li>What happens if my collector won’t get back up\n<ul>\n<li>Answer build a new one, open a change record, wait for approval, explain to audit why you don’t have logs</li>\n</ul>\n</li>\n<li>What happens to the format of the logs?\n<ul>\n<li>Answer Good question I can’t explain what MS is doing to these logs if you know please share</li>\n</ul>\n</li>\n<li>What about log rotation and archival\n<ul>\n<li>Answer not possible you need another tool to read back and store them some place (splunk)</li>\n</ul>\n</li>\n<li>My collector isn’t keeping up what do I do now?\n<ul>\n<li>Answer Well hopefully the org structure of your Domain will support creating an assignment policy at the OU level, you might be able to use the same policy/collector pair at multiple OU points but you might also need to break up the OUs to manage the policy.</li>\n</ul>\n</li>\n<li>Cross domain?\n<ul>\n<li>Answer 1 or more collectors per domain.</li>\n</ul>\n</li>\n<li>Wait I only want events XX and ZZYY from certain servers for compliance.\n<ul>\n<li>Answer you get another collection policy</li>\n</ul>\n</li>\n<li>I can’t make this work on server2134\n<ul>\n<li>Answer call Support at MS, explain what event collection is, hopefully convince that person it is supported</li>\n</ul>\n</li>\n<li>My sensitive “application/service log” doesn’t use the event log\n<ul>\n<li>Answer logfile this is windows who would do that?</li>\n</ul>\n</li>\n</ul>\n<p>Lets compare to universal forwarders with Splunk</p>\n<ul>\n<li>What happens if my “indexer” is down\n<ul>\n<li>Answer Client connect to another indexer, in a production system the indexer itself is replicated and you retain access to all data.</li>\n</ul>\n</li>\n<li>What happens if my collector won’t get back up\n<ul>\n<li>Answer. Data is replicated still available</li>\n</ul>\n</li>\n<li>What happens to the format of the logs?\n<ul>\n<li>Answer We capture the original text of all logs</li>\n</ul>\n</li>\n<li>What about log rotation and archival\n<ul>\n<li>Answer Built in</li>\n</ul>\n</li>\n<li>My collector isn’t keeping up what do I do now?\n<ul>\n<li>Answer Horizontal scaling Splunk will help you plan for this with experience and performance data from real world implementations</li>\n</ul>\n</li>\n<li>Cross domain?\n<ul>\n<li>Certainly, WAN no issue, Cloud not a problem. VPN sure why not</li>\n</ul>\n</li>\n<li>Wait I only want events XX and ZZYY from certain servers for compliance.\n<ul>\n<li>Deployment server will push a configuration based on the server names you select</li>\n</ul>\n</li>\n<li>I can’t make this work on server2134\n<ul>\n<li>Answer call Support (paid) at Splunk, we have real people with real knowledge and a great community who has probably solved that problem before.</li>\n</ul>\n</li>\n<li>My sensitive system doesn’t use the event log file it\n<ul>\n<li>Answer probably not a problem, files, database, network capture can be a data source we do this all the time.</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"Getting all the logs and avoiding the WEC","date":"November 05, 2015","description":null}},"previous":{"fields":{"slug":"/2015/09/16/getting-all-the-logs-avoid-the-syslog/"},"frontmatter":{"title":"Getting all the logs, avoid the syslog"}},"next":{"fields":{"slug":"/2015/11/06/get-started-with-splunk-app-stream-6-4-dns/"},"frontmatter":{"title":"Get started with Splunk App Stream 6.4 for DNS Analysis"}}},"pageContext":{"id":"e69d9166-3334-5378-8536-f1dc83e9c647","previousPostId":"638622d1-58ac-5589-949e-5e9a88e10195","nextPostId":"da4b5582-4e57-5c93-900c-d6a23d1c3a98"}},
    "staticQueryHashes": ["2841359383","3257411868"]}