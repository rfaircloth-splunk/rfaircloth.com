{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/2019/08/08/safely-exposing-splunk-s2s-to-the-internet/",
    "result": {"data":{"site":{"siteMetadata":{"title":"RFaircloth Data Nerd"}},"markdownRemark":{"id":"831cf554-ef9a-5f42-9138-ea6dd7916410","excerpt":"Splunk has a great token based auth solution for its S2S protocol it was added several versions back. Inputs have both just worked and remained unchanged for so…","html":"<p>Splunk has a great token based auth solution for its S2S protocol it was added several versions back. Inputs have both just worked and remained unchanged for so long many administrators have not noticed the feature. This allows you to safely expose indexers or heavy forwarders so that UFs on the internet can forward data back in without VPN. This is super critical for Splunk endpoints that don’t require a connection to the corporate network via VPN constantly</p>\n<p>When a Splunk input is exposed to the internet there is a risk of resource exhaustion dos. A simple type of attack where junk data or “well formed but misleading” data is feed to Splunk until all CPU/memory/disk is consumed.</p>\n<p>Once this feature is enabled all UF/HF clients must supply a token to be allowed to connect if your adding this feature to a running Splunk deployment be ready to push the outputs.conf update and inputs.conf updates in close succession to prevent a data flow break.</p>\n<p>Update your inputs.conf as follows, note you can use multiple tokens just like HEC so you can mitigate the number of tokens that need to be replaced if a stolen token is used in a DOS attack</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;pre class=\"mw-collapsed\"># Access control settings.\n[splunktcptoken://&lt;token name>]\n* Use this stanza to specify forwarders from which to accept data.\n* You must configure a token on the receiver, then configure the same\n  token on forwarders.\n* The receiver discards data from forwarders that do not have the\n  token configured.\n* This setting is enabled for all receiving ports.\n* This setting is optional.\n\ntoken = &lt;string>\n* token should match regex [A-Za-Z0-9\\-]+ and with a min length of 12</code></pre></div>\n<p>Update outputs.conf use the token value of choice from inputs.conf</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;pre class=\"mw-collapsed\">[tcpout:&lt;target_group>]\ntoken = &lt;string>\n* The access token for receiving data.\n* If you configured an access token for receiving data from a forwarder,\n  Splunk software populates that token here.\n* If you configured a receiver with an access token and that token is not\n  specified here, the receiver rejects all data sent to it.\n* This setting is optional.\n* No default.</code></pre></div>","frontmatter":{"title":"SafelyExposing Splunk S2S to the internet","date":"August 08, 2019","description":null}},"previous":{"fields":{"slug":"/2019/06/04/keeping-that-up-with-maxmind-for-splunk-and-splunk-cloud/"},"frontmatter":{"title":"Keeping that up with MaxMind for Splunk and Splunk Cloud"}},"next":{"fields":{"slug":"/2019/08/11/phishing-from-someone-elses-container-ship/"},"frontmatter":{"title":"Phishing from someone else's container ship."}}},"pageContext":{"id":"831cf554-ef9a-5f42-9138-ea6dd7916410","previousPostId":"7890b8d0-0515-5e2d-96eb-ec82a44ad3a8","nextPostId":"829bc479-5855-547e-bf09-08d8ccc9dff7"}},
    "staticQueryHashes": ["2841359383","3257411868"]}